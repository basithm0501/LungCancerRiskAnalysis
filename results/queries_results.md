# 📊 Lung Cancer Risk Analysis - Query Results & Insights

> **Generated by:** `running_queries.py`  
> **Source Queries:** `queries.sql`  
> **Purpose:** This document contains the results of SQL queries executed on the **lung cancer dataset**.  
> The queries analyze patient risk factors, demographics, and key relationships to identify trends in **pulmonary disease risk factors**.

---

## Query Name: 3) AVERAGE AGE FOR THOSE WITH PULMONARY DISEASE
**Purpose:** Identifies the average age of patients whose pulmonary_disease is TRUE.

**SQL:**
```sql
SELECT 
    AVG(age) AS avg_age_pulmonary_disease
FROM lung_cancer_data
WHERE pulmonary_disease = TRUE
```

**Result:**
| avg_age_pulmonary_disease |
|---------------------------|
| 57.099165                 |

**Insight:** The average age of patients with pulmonary disease is approximately 57.1 years.

---

## Query Name: 4) AVERAGE AGE FOR THOSE WITHOUT PULMONARY DISEASE
**Purpose:** Compares to see if there's a significant difference in average age.

**SQL:**
```sql
SELECT 
    AVG(age) AS avg_age_no_pulmonary_disease
FROM lung_cancer_data
WHERE pulmonary_disease = FALSE
```

**Result:**
| avg_age_no_pulmonary_disease |
|------------------------------|
| 57.307796                    |

**Insight:** The average age of patients without pulmonary disease is approximately 57.3 years, indicating no significant age difference between the two groups.

---

## Query Name: 5) COUNT & PERCENT OF SMOKERS VS NON-SMOKERS, GROUPED BY PULMONARY DISEASE
**Purpose:** Helps identify how smoking relates to disease frequency.

**SQL:**
```sql
SELECT 
    smoking,
    pulmonary_disease,
    COUNT(*) AS total_patients,
    ROUND(
      100.0 * COUNT(*) OVER (PARTITION BY pulmonary_disease) 
      / SUM(COUNT(*)) OVER (PARTITION BY pulmonary_disease), 
    2) AS percent_in_group
FROM lung_cancer_data
GROUP BY smoking, pulmonary_disease
ORDER BY pulmonary_disease DESC, smoking DESC
```

**Result:**
| smoking | pulmonary_disease | total_patients | percent_in_group |
|---------|-------------------|----------------|------------------|
| True    | True              | 1892           | 0.10             |
| False   | True              | 145            | 0.10             |
| True    | False             | 1440           | 0.07             |
| False   | False             | 1523           | 0.07             |

**Insight:** Smoking slightly increases the prevalence of pulmonary disease (10% vs. 7%).

---

## Query Name: 6) AVERAGE & MIN/MAX OXYGEN SATURATION BY PULMONARY DISEASE
**Purpose:** Shows if there's a notable difference in oxygen levels.

**SQL:**
```sql
SELECT 
    pulmonary_disease,
    AVG(oxygen_saturation) AS avg_oxygen,
    MIN(oxygen_saturation) AS min_oxygen,
    MAX(oxygen_saturation) AS max_oxygen
FROM lung_cancer_data
GROUP BY pulmonary_disease
ORDER BY pulmonary_disease DESC
```

**Result:**
| pulmonary_disease | avg_oxygen | min_oxygen | max_oxygen |
|-------------------|------------|------------|------------|
| True              | 95.024196  | 89.923133  | 99.795786  |
| False             | 94.968228  | 90.187572  | 99.737350  |

**Insight:** Oxygen saturation levels do not differ significantly between patients with and without pulmonary disease.

---

## Query Name: 7) HIGH-RISK DEMOGRAPHIC #1
**Purpose:** Identifies how many high-risk patients (older than 60, smokers, and have exposure_to_pollution) also have pulmonary_disease = TRUE.

**SQL:**
```sql
SELECT 
    COUNT(*) AS high_risk_count
FROM lung_cancer_data
WHERE age > 60
  AND smoking = TRUE
  AND exposure_to_pollution = TRUE
  AND pulmonary_disease = TRUE
```

**Result:**
| high_risk_count |
|-----------------|
| 466             |

**Insight:** There are 466 high-risk patients who are older than 60, smokers, and have pollution exposure, and also have pulmonary disease.

---

## Query Name: 8) HIGH-RISK DEMOGRAPHIC #2
**Purpose:** Identifies patients with family_history, smoking_family_history, and immune_weakness, grouped by pulmonary_disease status.

**SQL:**
```sql
SELECT 
    pulmonary_disease,
    COUNT(*) AS count_with_family_risk
FROM lung_cancer_data
WHERE family_history = TRUE
  AND smoking_family_history = TRUE
  AND immune_weakness = TRUE
GROUP BY pulmonary_disease
ORDER BY count_with_family_risk DESC
```

**Result:**
| pulmonary_disease | count_with_family_risk |
|-------------------|------------------------|
| True              | 320                    |
| False             | 95                     |

**Insight:** Family history and immune system weakness significantly increase the risk of pulmonary disease.

---

## Query Name: 9) AVERAGE ENERGY LEVEL BY BREATHING_ISSUE
**Purpose:** Compares the energy level for those who have breathing issues vs. those who don't.

**SQL:**
```sql
SELECT 
    breathing_issue,
    AVG(energy_level) AS avg_energy
FROM lung_cancer_data
GROUP BY breathing_issue
ORDER BY avg_energy ASC
```

**Result:**
| breathing_issue | avg_energy |
|-----------------|------------|
| True            | 55.028469  |
| False           | 55.046377  |

**Insight:** Energy levels are not strongly impacted by breathing issues.

---

## Query Name: 10) DISTRIBUTION: MENTAL_STRESS VS. STRESS_IMMUNE
**Purpose:** Reveals how mental stress correlates with stress_immune and the proportion of each category with pulmonary_disease.

**SQL:**
```sql
SELECT 
    mental_stress,
    stress_immune,
    COUNT(*) AS total_patients,
    SUM(CASE WHEN pulmonary_disease = TRUE THEN 1 ELSE 0 END) AS disease_positive,
    ROUND(
      100.0 * SUM(CASE WHEN pulmonary_disease = TRUE THEN 1 ELSE 0 END) 
      / COUNT(*), 
    2) AS percent_disease_positive
FROM lung_cancer_data
GROUP BY mental_stress, stress_immune
ORDER BY percent_disease_positive DESC
```

**Result:**
| mental_stress | stress_immune | total_patients | disease_positive | percent_disease_positive |
|---------------|---------------|----------------|------------------|--------------------------|
| True          | True          | 1048           | 608              | 58.02                    |
| True          | False         | 1651           | 601              | 36.40                    |
| False         | False         | 2301           | 828              | 35.98                    |

**Insight:** Mental stress combined with stress_immune significantly increases the likelihood of pulmonary disease.

---

## Query Name: 11) GROUPED STATISTICS ACROSS MULTIPLE BOOLEAN COLUMNS
**Purpose:** Summarizes per group of: (smoking, alcohol_consumption, pulmonary_disease) to see how many are in each combination, plus average age & average oxygen.

**SQL:**
```sql
SELECT
    smoking,
    alcohol_consumption,
    pulmonary_disease,
    COUNT(*) AS group_count,
    ROUND(CAST(AVG(age) AS NUMERIC), 2) AS avg_age,
    ROUND(CAST(AVG(oxygen_saturation) AS NUMERIC), 2) AS avg_oxy
FROM lung_cancer_data
GROUP BY smoking, alcohol_consumption, pulmonary_disease
ORDER BY group_count DESC
```

**Result:**
| smoking | alcohol_consumption | pulmonary_disease | group_count | avg_age | avg_oxy |
|---------|---------------------|-------------------|-------------|---------|---------|
| True    | False               | True              | 1224        | 57.27   | 94.99   |
| False   | False               | False             | 1001        | 57.38   | 94.93   |
| True    | False               | False             | 913         | 56.88   | 94.97   |
| True    | True                | True              | 668         | 56.53   | 95.08   |
| True    | True                | False             | 527         | 56.46   | 95.00   |
| False   | True                | False             | 522         | 58.78   | 95.02   |
| False   | False               | True              | 91          | 58.92   | 95.09   |
| False   | True                | True              | 54          | 57.15   | 94.87   |

**Insight:** The combination of smoking and alcohol consumption does not significantly alter the average age or oxygen saturation levels among patients with pulmonary disease.

---

## Query Name: 12) CHECK RELATION: LONG_TERM_ILLNESS AND PULMONARY_DISEASE
**Purpose:** Checks if having a long-term illness correlates strongly with pulmonary disease.

**SQL:**
```sql
SELECT
    long_term_illness,
    pulmonary_disease,
    COUNT(*) AS total_patients
FROM lung_cancer_data
GROUP BY long_term_illness, pulmonary_disease
ORDER BY total_patients DESC
```

**Result:**
| long_term_illness | pulmonary_disease | total_patients |
|-------------------|-------------------|----------------|
| False             | False             | 1677           |
| True              | False             | 1286           |
| False             | True              | 1127           |
| True              | True              | 910            |

**Insight:** There is a notable correlation between long-term illness and pulmonary disease.

---

## Query Name: 13) INTERSECTION OF MULTIPLE FACTORS
**Purpose:** Among those who have (breathing_issue = TRUE) and (mental_stress = TRUE), identifies how many also have chest_tightness = TRUE, grouped by pulmonary_disease.

**SQL:**
```sql
SELECT 
    pulmonary_disease,
    COUNT(*) AS total_subset
FROM lung_cancer_data
WHERE breathing_issue = TRUE
  AND mental_stress = TRUE
  AND chest_tightness = TRUE
GROUP BY pulmonary_disease
ORDER BY total_subset DESC
```

**Result:**
| pulmonary_disease | total_subset |
|-------------------|--------------|
| True              | 694          |
| False             | 622          |

**Insight:** A significant number of patients with breathing issues, mental stress, and chest tightness also have pulmonary disease.

---

## 🔹 Final Conclusions
### 🔍 Key Findings
- Pulmonary disease is not strongly correlated with age (average ~57 years).
- Smoking slightly increases disease prevalence, but not drastically (10% vs. 7%).
- Oxygen saturation levels do not differ significantly between affected and unaffected groups.
- Individuals aged >60 who smoke and have pollution exposure are at high risk.
- Family history and immune system weakness significantly increase risk.
- Energy levels are not strongly impacted by breathing issues.

### 📌 Recommendations
- Further analysis should explore other risk factors, such as diet and occupational exposure.
- A logistic regression model could help predict lung cancer risk based on these features.
- More data on smoking intensity and duration would be valuable to strengthen the analysis.